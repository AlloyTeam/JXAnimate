<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>jx/jx.ui.tooltip.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/JXAnimation.Audio.html">JXAnimation.Audio</a></li>
            
                <li><a href="../classes/Log.html">Log</a></li>
            
                <li><a href="../classes/Tab.html">Tab</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/JXAnimate.Audio.html">JXAnimate.Audio</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: jx/jx.ui.tooltip.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/** 
 * JX (Javascript eXtension tools) 
 * Copyright (c) 2011, Tencent.com, All rights reserved.
 *
 * @fileOverview Jet!
 * @version 1.0
 * @author  Kinvix(&lt;a href=&quot;mailto:Kinvix@gmail.com&quot;&gt;Kinvix@gmail.com&lt;/a&gt;)
 * @description 
 * 
 */

Jx().$package(function (J) {
    var $ = J.dom.id,
        $D = J.dom,
        $S = J.string,
        $A = J.array,
        $E = J.event,
        $T = J.fx.transitions;
        
    // Tooltip类
    /**
     * 【Tooltip】
     * 
     * @class 
     * @memberOf ui
     * @constructor
     * @name Tooltip
     * @param {Element} els 需要生成tooltip的DOM节点
     * @param {Object} option 参数对象 option:{text:&#x27;tooltip内容，默认去title属性&#x27;}
     * @since version 1.0
     * @description Jx.ui.Tooltip是一个长方形的小提示，在用户将指针悬停在一个控件上时显示有关该控件用途的简短说明。
     */
    var Tooltip = new J.Class(
    /**
     * @lends ui.Tooltip.prototype
     */ 
    {
        /**
        * @ignore
        */
        init: function (els, option) {
            var tooltipContext = this;
            option = option || {};
            
            tooltipContext.id = Tooltip.count;
            Tooltip.count++;
            
            $A.forEach(els, function(el,i,els){
                var text = option.text || el.getAttribute(&quot;title&quot;);
                
                // 检测文字所需要的宽度
                var width;
                var tempEl = $D.node(&quot;div&quot;,{
                    style:&quot;float:left;width:auto;background:blue;visibility:hidden;&quot;
                });
                document.body.appendChild(tempEl);
                tempEl.innerHTML = text;
                width = $D.getClientWidth(tempEl, &quot;width&quot;);
                width += (width % 2);
                document.body.removeChild(tempEl);
                tempEl = null;
                
                
                
                el.removeAttribute(&quot;title&quot;);

                if(!J.isUndefined(text)) {
                    /**
                     * @ignore
                     */
                    tooltipContext.mouseMove = function(e){
                        var tooltipEL = tooltipContext.tooltipEL;
                        var tipX = e.pageX + 24;
                        var tipY = e.pageY - 18;
                        var tipWidth = $D.getWidth(tooltipEL);
                        var tipHeight = $D.getHeight(tooltipEL);
//                      if(tipX + tipWidth &gt; $D.getScrollLeft(document.body) + $D.getWidth(document.body)){
//                          tipX = e.pageX - tipWidth;
//                      }
//                      if($D.getHeight(document.body)+$D.getScrollTop(document.body) &lt; tipY + tipHeight){
//                          tipY = e.pageY - tipHeight;
//                      }
                        $D.setXY(tooltipEL, tipX, tipY);
                    };
                    
                    $E.on(el, &quot;mouseover&quot;, function(e){
                        var tipX = e.pageX + 24;
                        var tipY = e.pageY - 18;
                        if(!tooltipContext.tooltipEL){
                            tooltipContext.createTooltip();
                        }
                        var tooltipTextEL = tooltipContext.tooltipTextEL;
                        tooltipTextEL.innerHTML = text;
                        
                        tooltipContext.showIn({width:width});
                        
                    });
                    
                    $E.on(el, &quot;mouseout&quot;, function(e){
                        if(tooltipContext.tooltipEL){
                            tooltipContext.showOut({width:width});
                        }
                    });
                }
            });
            
        },
        
        /**
        * @private
        */
        createTooltip: function(){
            var tooltipContext = this;
            var tooltipEL;
            var tooltipTextEL;
            var tempLeftEL;
            var tempRightEL;
            
            
            var tooltipTextELBg = &#x27;background:url(http://qplus1.idqqimg.com/jx/style/image/tooltip_c.png?t=20111011001);&#x27;,
                tooltipLeftELBg =  &#x27;background:url(http://qplus1.idqqimg.com/jx/style/image/tooltip.png?t=20111011001) no-repeat;&#x27;,
                tooltipRightELBg = &#x27; background:url(http://qplus1.idqqimg.com/jx/style/image/tooltip.png?t=20111011001) no-repeat right&#x27;;
            
            if(J.browser.ie &amp;&amp; J.browser.ie == 6){
                tooltipTextELBg = &#x27;filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src=&quot;http://qplus1.idqqimg.com/jx/style/image/tooltip_c.png?t=20111011001&quot;, sizingMethod=&quot;scale&quot;);&#x27;;
                tooltipLeftELBg = &#x27;filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src=&quot;http://qplus1.idqqimg.com/jx/style/image/tooltip_l.png?t=20111011001&quot;, sizingMethod=&quot;scale&quot;);&#x27;;
                tooltipRightELBg = &#x27;filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src=&quot;http://qplus1.idqqimg.com/jx/style/image/tooltip_r.png?t=20111011001&quot;, sizingMethod=&quot;scale&quot;);&#x27;;
            }
            
            tooltipContext.tooltipEL = tooltipEL = $D.node(&quot;div&quot;,{
                id:&quot;jxTooltip_&quot;+tooltipContext.id,
                style:&#x27;position: absolute; margin:10px; width:107px; height:38px; z-index: 10000; display: none;&#x27;
            });
            
            tooltipContext.tooltipTextEL = tooltipTextEL = $D.node(&quot;div&quot;,{
                id:&quot;jxTooltipText_&quot;+tooltipContext.id,
                style:&#x27;line-height:30px; width:100%; height:38px; color:white; overflow:hidden;&#x27; + tooltipTextELBg
            });

            tempLeftEL = $D.node(&quot;div&quot;,{
                style:&#x27;position:absolute; left:-12px; width:12px; height:38px; overflow:hidden;&#x27; + tooltipLeftELBg 
            });
            tempRightEL = $D.node(&quot;div&quot;,{
                style:&#x27;position:absolute; right:-12px; width:12px; height:38px; overflow:hidden;&#x27; + tooltipRightELBg
            });
            
            tooltipEL.appendChild(tempLeftEL);
            tooltipEL.appendChild(tempRightEL);
            tooltipEL.appendChild(tooltipTextEL);

            document.body.appendChild(tooltipEL);
            //$D.setStyle(tooltipEL, &quot;opacity&quot;, 0);
            tooltipContext.showInAnimation = new J.fx.Animation({
                element:tooltipEL,
                property:&quot;width&quot;,
                from:0,
                to:1,
                unit:&quot;px&quot;,
                duration:300,
                transition:$T.sinusoidal.easeOut
            });
            
            tooltipContext.showOutAnimation = new J.fx.Animation({
                element:tooltipEL,
                property:&quot;width&quot;,
                from:1,
                to:0,
                unit:&quot;px&quot;,
                duration:300,
                transition:$T.sinusoidal.easeOut
            });
            
            $E.addObserver(tooltipContext.showOutAnimation,&quot;end&quot;, function(){
                $D.hide(tooltipEL);
            });
            
        },
        
        /**
        * 显示tooltip
        * @param {Object} option 参数对象 option:{width:&#x27;tooltip宽度&#x27;}
        * @return 
        */
        showIn:function(option){
            var tooltipContext = this;
            var tooltipEL = tooltipContext.tooltipEL;
            
            tooltipContext.showOutAnimation.end();
            $E.on(document, &quot;mousemove&quot;, tooltipContext.mouseMove);
            $D.show(tooltipEL);
            tooltipContext.showInAnimation.start(0,option.width);
        },
        
        /**
        * 隐藏tooltip
        * @param {Object} option 参数对象 option:{width:&#x27;tooltip宽度&#x27;}
        * @return 
        */
        showOut:function(option){
            var tooltipContext = this;
            var tooltipEL = tooltipContext.tooltipEL;
            
            tooltipContext.showInAnimation.end();
            //alert(option.width)

            tooltipContext.showOutAnimation.start(option.width,0);
            $E.addObserver(tooltipContext.showOutAnimation, &#x27;end&#x27;, function(e){
                $E.off(document, &quot;mousemove&quot;, tooltipContext.mouseMove);
            });
            //$D.hide(tooltipEL);
        },
        
        /**
        * 关于tooltip
        * @private
        */
        about:function(){
            alert(&quot;Jx().ui.Tooltip() by Jetyu of Tencent!&quot;);
        }
       

    });


    
//  Tooltip.options = {
//      src: &quot;http://image.apple.com/global/elements/zoomerlay/zoomerlay_tooltip.png?t=20111011001&quot;,
//      pos: &quot;top&quot;,
//      dist: 5,
//      deadspace: 0
//  };
    
    Tooltip.count = 0;
    
    J.ui = J.ui || {};
    J.ui.Tooltip = Tooltip;
});
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
