<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>jx/jx.ui.pagination.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/JXAnimation.Audio.html">JXAnimation.Audio</a></li>
            
                <li><a href="../classes/Log.html">Log</a></li>
            
                <li><a href="../classes/Tab.html">Tab</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/JXAnimate.Audio.html">JXAnimate.Audio</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: jx/jx.ui.pagination.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
Jx().$package(function (J) {
    var $D = J.dom,
        $E = J.event;
        
    J.ui = J.ui || {};

    /**
     * 【Pagination】
     * 
     * @class 
     * @memberOf ui
     * @name Pagination
     * @param {Object} option 参数对象 option:{el:DOM分页容器, count: 总数, prePage: 每页数量, type: 分页类型(1/2), callback: 回调}&lt;br/&gt;
     * option.type 分页类型,type=1:带省略号,有页码列表;type=2:无省略号,没页码列表
     * @since version 1.0
     * @description Jx.ui.Pagination是一个分页组件，当在页面上需要使用列表来展示较多数据时，可以使用该组件实现分页切换效果。
     */
     J.ui.Pagination = new J.Class(
     /**
     * @lends ui.Pagination.prototype
     */
     {
        /**
        * @ignore
        */
        init:function(option){
            this.pagebarEl = option.el;
            this.count = option.count;
            this.perPage = option.perPage || 10;
            this.callback = option.callback||function(){};
            this.type = option.type||1;
            this.maxPage = Math.ceil(this.count/this.perPage);
            this.currentPage=option.currentPage||1;
            var paginationEl = this.pagebarEl.children[0];
            this.pagelistEl = paginationEl.children[1];
            this.preEl = paginationEl.children[0];
            this.nextEl = paginationEl.children[2];
            
            
            if (this.maxPage &gt; 1) {
                $D.show(this.pagebarEl);
            } else {
                $D.hide(this.pagebarEl);
            }
            //this.setPage(this.currentPage);
            this.turnTo(this.currentPage, true);
            $E.on(this.preEl,&quot;click&quot;,J.bind(this.onPreElClick,this));
            $E.on(this.nextEl,&quot;click&quot;,J.bind(this.onNextElClick,this));
        },
        
        /**
        * 重置分页组件
        * @param {Object} option 参数对象 option:{el:DOM分页容器, count: 总数, prePage: 每页数量, type: 分页类型(1/2), callback: 回调}
        * @return
        */
        reset : function(option){
            this.count = J.isNumber(option.count)?option.count:this.count;
            this.perPage = option.perPage ||this.perPage|| 10;
            this.callback = option.callback||this.callback||function(){};
            this.type = option.type||this.type||1;
            this.currentPage = option.currentPage||this.currentPage||1;
            this.maxPage = Math.ceil(this.count/this.perPage);
            if (this.maxPage &gt; 1) {
                $D.show(this.pagebarEl);
            } else {
                $D.hide(this.pagebarEl);
            }
            this.setPage(this.currentPage);
        },
        
        /**
        * @private
        * 设置
        */
        setPage:function(page){
            var html = &quot;&quot;, totalPage = this.maxPage;
            this.currentPage = page;

            if (page &gt; totalPage || page &lt; 1) {
                return;
            }
            //第一种模版,带省略号
            if(this.type == 1){
                if( totalPage &gt; 8 ){
                    html += &#x27;&lt;a class=&quot;w&#x27;+ ((page+&#x27;&#x27;).length) + (page==1?&#x27; cur&#x27;:&quot;&quot;)+&#x27;&quot; href=&quot;#&quot; &gt;1&lt;/a&gt;&#x27;;
                    if(page &lt; 4){
                        for(var i=2; i&lt;5; i++){
                            html += &#x27;&lt;a class=&quot;w&#x27;+ ((i+&#x27;&#x27;).length) +(i==page?&#x27; cur&#x27;:&quot;&quot;)+&#x27;&quot; href=&quot;#&quot; &gt;&#x27;+i+&#x27;&lt;/a&gt;&#x27;;
                        }
                        html += &#x27;&lt;span&gt;...&lt;/span&gt;&#x27;;
                    }else if( (page+3) &gt; totalPage){
                        html += &#x27;&lt;span&gt;...&lt;/span&gt;&#x27;;  
                        for(var i=(totalPage-3); i&lt;totalPage; i++){
                            html += &#x27;&lt;a class=&quot;w&#x27;+ ((i+&#x27;&#x27;).length) +(i==page?&#x27; cur&#x27;:&quot;&quot;)+&#x27;&quot; href=&quot;#&quot; &gt;&#x27;+i+&#x27;&lt;/a&gt;&#x27;;
                        }
                    }else{ 
                        html += &#x27;&lt;span&gt;...&lt;/span&gt;&#x27;;
                        for(var i=(page-1); i &lt; (page+2); i++){
                            html += &#x27;&lt;a class=&quot;w&#x27;+ ((i+&#x27;&#x27;).length) +(i==page?&#x27; cur&#x27;:&quot;&quot;)+&#x27;&quot; href=&quot;#&quot; &gt;&#x27;+i+&#x27;&lt;/a&gt;&#x27;;
                        }
                        html += &#x27;&lt;span&gt;...&lt;/span&gt;&#x27;;
                    }
                    html += &#x27;&lt;a class=&quot;w&#x27;+ ((totalPage+&#x27;&#x27;).length) +(page==totalPage?&#x27; cur&#x27;:&quot;&quot;)+&#x27;&quot; href=&quot;#&quot; &gt;&#x27;+totalPage+&#x27;&lt;/a&gt;&#x27;;
                }else{
                    for( var i=1; i&lt;=totalPage; i++){
                        html += &#x27;&lt;a class=&quot;w&#x27;+ ((i+&#x27;&#x27;).length) +(i==page?&#x27; cur&#x27;:&quot;&quot;)+&#x27;&quot; href=&quot;#&quot; &gt;&#x27;+i+&#x27;&lt;/a&gt;&#x27;;
                    }
                }
    
                this.pagelistEl.innerHTML = html;
                $D.setStyle(this.pagebarEl,&quot;width&quot;,&quot;auto&quot;);
                $D.setStyle(this.pagebarEl,&quot;width&quot;,$D.getClientWidth(this.pagebarEl.children[0])+10+&quot;px&quot;);
                var pagelink = $D.tagName(&quot;a&quot;,this.pagelistEl), i=0, len=pagelink.length;
                for (; i&lt;len; i++) {
                    $E.on(pagelink[i],&quot;click&quot;,J.bind(this.onPagesElClick,this));
                }
                
            }else if(this.type==2){//第二种模版,不带省略号
                html = page+&quot;/&quot;+totalPage;
                this.pagelistEl.innerHTML = html;
            }
            

            $D.removeClass(this.preEl,&quot;preBtn_dis&quot;);
            $D.removeClass(this.nextEl,&quot;nextBtn_dis&quot;);

            if(page == 1){
                $D.addClass(this.preEl,&quot;preBtn_dis&quot;);
            } else if(page == totalPage){
                $D.addClass(this.nextEl,&quot;nextBtn_dis&quot;);
            }
        },
        
        /**
        * 切换到 指定页
        * @param page {Number} 页码
        * @param force {Boolean} 内部使用参数，可以不填或false
        */
        turnTo: function(page, force){
            if (isNaN(page) || page &lt; 1 || page &gt; this.maxPage || (!force &amp;&amp; page == this.currentPage)) {
                return;
            }

            this.setPage(page);
            this.callback({start:this.getStart(), end:this.getEnd()});
        },
        
        /**
        * @private 
        */
        onPagesElClick:function(e){
            e.stopPropagation();
            e.preventDefault();

            var page = +e.currentTarget.innerHTML;
            this.turnTo(page);
            /*if (isNaN(page) || page &lt; 1 || page &gt; this.maxPage || page == this.currentPage) {
                return;
            }

            this.setPage(page);
            this.callback({start:this.getStart(), end:this.getEnd()});*/
            //$E.notifyObservers(this.context, &quot;SetPage&quot;, {start:this.getStart(), end:this.getEnd()});
        },
        
        /**
        * @private 
        */
        onPreElClick:function(e){
            e.stopPropagation();
            e.preventDefault();

            if (this.currentPage &gt; 1) {
                this.currentPage--;
                this.setPage(this.currentPage);
                this.callback({start:this.getStart(), end:this.getEnd()});
                //$E.notifyObservers(this.context, &quot;SetPage&quot;, {start:this.getStart(), end:this.getEnd()});
            }
        },
        
        /**
        * @private 
        */
        onNextElClick:function(e){
            e.stopPropagation();
            e.preventDefault();

            if (this.currentPage &lt; this.maxPage) {
                this.currentPage++;
                this.setPage(this.currentPage);
                this.callback({start:this.getStart(), end:this.getEnd()});
                //$E.notifyObservers(this.context, &quot;SetPage&quot;, {start:this.getStart(), end:this.getEnd()});
            }
        },
        
        /**
        * 获取当前页列表起始索引值
        * @param
        * @return {Number} 当前页列表起始索引值
        */
        getStart:function(){
            return (this.currentPage-1)*this.perPage;
        },
        
        /**
        * 获取当前页列表结束索引值
        * @param
        * @return {Number} 当前页列表结束索引值
        */
        getEnd:function(){
            var end = (this.currentPage*this.perPage)-1;
            if(end &gt; this.count - 1)
                end = this.count - 1;
            return end;
        }
    });
});
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
